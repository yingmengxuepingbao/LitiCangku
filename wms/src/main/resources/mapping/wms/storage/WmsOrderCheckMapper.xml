<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.penghaisoft.wms.storagemanagement.model.dao.WmsOrderCheckMapper">

	<!-- =========================================================== -->
	<!-- 定义resultMap                                                                                                                                                                             -->
	<!-- =========================================================== -->
	<resultMap id="wmsOrderCheckMap" type="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		<result property="checkId" column="check_id"/>
		<result property="orderNo" column="order_no"/>
		<result property="orderType" column="order_type"/>
		<result property="orderStatus" column="order_status"/>
		<result property="areaCode" column="area_code"/>
		<result property="areaType" column="area_type"/>
		<result property="diffFlag" column="diff_flag"/>
		<result property="goodsName" column="goods_name"/>
		<result property="goodsCode" column="goods_code"/>
		<result property="locationCode" column="location_code"/>
		<result property="remark" column="remark"/>
		<result property="userDefined1" column="user_defined1"/>
		<result property="userDefined2" column="user_defined2"/>
		<result property="userDefined3" column="user_defined3"/>
		<result property="userDefined4" column="user_defined4"/>
		<result property="userDefined5" column="user_defined5"/>
		<result property="createBy" column="create_by"/>
		<result property="gmtCreate" column="gmt_create"/>
		<result property="lastModifiedBy" column="last_modified_by"/>
		<result property="gmtModified" column="gmt_modified"/>
		<result property="activeFlag" column="active_flag"/>

		<result property="planPalletAmount" column="planPalletAmount"/>
		<result property="realPalletAmount" column="realPalletAmount"/>
		<result property="planGoodsAmount" column="planGoodsAmount"/>
		<result property="realGoodsAmount" column="realGoodsAmount"/>
	</resultMap>

	<!-- =========================================================== -->
	<!-- 一些公共变量设置                                                                                                                                                                             -->
	<!-- =========================================================== -->
	<!-- mysql 分页 -->
	<sql id="pagination_tail">
		top ((#{page.pageOffset} +1)* #{page.rows})
	</sql>
	<!-- mysql 查询总数 -->
	<sql id="count_Tail">
		select count(1) from
	</sql>

	<sql id="selectAllColumns">
		<![CDATA[
			wms_order_check_.check_id,
			wms_order_check_.order_no,
			wms_order_check_.order_type,
			wms_order_check_.order_status,
			wms_order_check_.area_code,
			s.area_type,
			wms_order_check_.diff_flag,
			wms_order_check_.goods_name,
			wms_order_check_.goods_code,
			wms_order_check_.location_code,
			wms_order_check_.remark,
			wms_order_check_.user_defined1,
			wms_order_check_.user_defined2,
			wms_order_check_.user_defined3,
			wms_order_check_.user_defined4,
			wms_order_check_.user_defined5,
			wms_order_check_.create_by,
			wms_order_check_.gmt_create,
			wms_order_check_.last_modified_by,
			wms_order_check_.gmt_modified,
			wms_order_check_.active_flag
		FROM
			wms_order_check wms_order_check_
				LEFT JOIN wms_warehouse_area s ON wms_order_check_.area_code = s.area_code
				AND s.active_flag = '1'
		]]>
	</sql>

	<sql id="where_fragement">
		where 1=1
		<if test="entity!=null">
			<if test="entity.checkId != null and entity.checkId !=''">
				<![CDATA[ and wms_order_check_.check_id LIKE CONCAT('%',#{entity.checkId},'%')]]>
			</if>
			<if test="entity.orderNo != null and entity.orderNo !=''">
				<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
			</if>
			<if test="entity.orderType != null and entity.orderType !=''">
				<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
			</if>
			<if test="entity.orderStatus != null and entity.orderStatus !=''">
				<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
			</if>
			<if test="entity.areaCode != null and entity.areaCode !=''">
				<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
			</if>
			<if test="entity.diffFlag != null and entity.diffFlag !=''">
				<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
			</if>
			<if test="entity.goodsName != null and entity.goodsName !=''">
				<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
			</if>
			<if test="entity.goodsCode != null and entity.goodsCode !=''">
				<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
			</if>
			<if test="entity.locationCode != null and entity.locationCode !=''">
				<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
			</if>
			<if test="entity.remark != null and entity.remark !=''">
				<![CDATA[ and wms_order_check_.remark LIKE CONCAT('%',#{entity.remark},'%')]]>
			</if>
			<if test="entity.userDefined1 != null and entity.userDefined1 !=''">
				<![CDATA[ and wms_order_check_.user_defined1 LIKE CONCAT('%',#{entity.userDefined1},'%')]]>
			</if>
			<if test="entity.userDefined2 != null and entity.userDefined2 !=''">
				<![CDATA[ and wms_order_check_.user_defined2 LIKE CONCAT('%',#{entity.userDefined2},'%')]]>
			</if>
			<if test="entity.userDefined3 != null and entity.userDefined3 !=''">
				<![CDATA[ and wms_order_check_.user_defined3 LIKE CONCAT('%',#{entity.userDefined3},'%')]]>
			</if>
			<if test="entity.userDefined4 != null and entity.userDefined4 !=''">
				<![CDATA[ and wms_order_check_.user_defined4 LIKE CONCAT('%',#{entity.userDefined4},'%')]]>
			</if>
			<if test="entity.userDefined5 != null and entity.userDefined5 !=''">
				<![CDATA[ and wms_order_check_.user_defined5 LIKE CONCAT('%',#{entity.userDefined5},'%')]]>
			</if>
			<if test="entity.createBy != null and entity.createBy !=''">
				<![CDATA[ and wms_order_check_.create_by LIKE CONCAT('%',#{entity.createBy},'%')]]>
			</if>
			<if test="entity.gmtCreate != null">
				<![CDATA[ and wms_order_check_.gmt_create LIKE CONCAT('%',#{entity.gmtCreate},'%')]]>
			</if>
			<if test="entity.lastModifiedBy != null and entity.lastModifiedBy !=''">
				<![CDATA[ and wms_order_check_.last_modified_by LIKE CONCAT('%',#{entity.lastModifiedBy},'%')]]>
			</if>
			<if test="entity.gmtModified != null">
				<![CDATA[ and wms_order_check_.gmt_modified LIKE CONCAT('%',#{entity.gmtModified},'%')]]>
			</if>
			<if test="entity.activeFlag != null and entity.activeFlag !=''">
				<![CDATA[ and wms_order_check_.active_flag LIKE CONCAT('%',#{entity.activeFlag},'%')]]>
			</if>
		</if>
	</sql>

	<sql id="where_any">
		where 1=1
		<if test="entity!=null">
			<if test="entity.checkId != null and entity.checkId !=''">
				<![CDATA[ and wms_order_check_.check_id = #{entity.checkId}]]>
			</if>
			<if test="entity.orderNo != null and entity.orderNo !=''">
				<![CDATA[ and wms_order_check_.order_no = #{entity.orderNo}]]>
			</if>
			<if test="entity.orderType != null and entity.orderType !=''">
				<![CDATA[ and wms_order_check_.order_type = #{entity.orderType}]]>
			</if>
			<if test="entity.orderStatus != null and entity.orderStatus !=''">
				<![CDATA[ and wms_order_check_.order_status = #{entity.orderStatus}]]>
			</if>
			<if test="entity.areaCode != null and entity.areaCode !=''">
				<![CDATA[ and wms_order_check_.area_code = #{entity.areaCode}]]>
			</if>
			<if test="entity.diffFlag != null and entity.diffFlag !=''">
				<![CDATA[ and wms_order_check_.diff_flag = #{entity.diffFlag}]]>
			</if>
			<if test="entity.goodsName != null and entity.goodsName !=''">
				<![CDATA[ and wms_order_check_.goods_name = #{entity.goodsName}]]>
			</if>
			<if test="entity.goodsCode != null and entity.goodsCode !=''">
				<![CDATA[ and wms_order_check_.goods_code = #{entity.goodsCode}]]>
			</if>
			<if test="entity.locationCode != null and entity.locationCode !=''">
				<![CDATA[ and wms_order_check_.location_code = #{entity.locationCode}]]>
			</if>
			<if test="entity.remark != null and entity.remark !=''">
				<![CDATA[ and wms_order_check_.remark = #{entity.remark}]]>
			</if>
			<if test="entity.userDefined1 != null and entity.userDefined1 !=''">
				<![CDATA[ and wms_order_check_.user_defined1 = #{entity.userDefined1}]]>
			</if>
			<if test="entity.userDefined2 != null and entity.userDefined2 !=''">
				<![CDATA[ and wms_order_check_.user_defined2 = #{entity.userDefined2}]]>
			</if>
			<if test="entity.userDefined3 != null and entity.userDefined3 !=''">
				<![CDATA[ and wms_order_check_.user_defined3 = #{entity.userDefined3}]]>
			</if>
			<if test="entity.userDefined4 != null and entity.userDefined4 !=''">
				<![CDATA[ and wms_order_check_.user_defined4 = #{entity.userDefined4}]]>
			</if>
			<if test="entity.userDefined5 != null and entity.userDefined5 !=''">
				<![CDATA[ and wms_order_check_.user_defined5 = #{entity.userDefined5}]]>
			</if>
			<if test="entity.createBy != null and entity.createBy !=''">
				<![CDATA[ and wms_order_check_.create_by = #{entity.createBy}]]>
			</if>
			<if test="entity.gmtCreate != null">
				<![CDATA[ and wms_order_check_.gmt_create = #{entity.gmtCreate}]]>
			</if>
			<if test="entity.lastModifiedBy != null and entity.lastModifiedBy !=''">
				<![CDATA[ and wms_order_check_.last_modified_by = #{entity.lastModifiedBy}]]>
			</if>
			<if test="entity.gmtModified != null">
				<![CDATA[ and wms_order_check_.gmt_modified = #{entity.gmtModified}]]>
			</if>
			<if test="entity.activeFlag != null and entity.activeFlag !=''">
				<![CDATA[ and wms_order_check_.active_flag = #{entity.activeFlag}]]>
			</if>
		</if>
	</sql>

	<!-- =========================================================== -->
	<!-- DAO方法中的基本增删改查方法                                                                                                                                                           -->
	<!-- =========================================================== -->
	<!-- 根据id查询 -->
	<select id="queryById" resultMap="wmsOrderCheckMap" parameterType="java.lang.String">
		select
		<include refid="selectAllColumns" />
		<![CDATA[
		where wms_order_check_.check_id = #{id}
		]]>
	</select>

	<!-- 分页查询 -->
	<select id="queryList" resultMap="wmsOrderCheckMap" >
		select
		<if test="page!=null">
			<include refid="pagination_tail" />
		</if>
		<include refid="selectAllColumns"/>
		<include refid="where_fragement" />
		<if test="entity.orderBy != null and entity.orderBy !=''">
			<![CDATA[ order by ${entity.orderBy}]]>
		</if>

	</select>

	<select id="queryCount" resultType="long">
		<include refid="count_Tail" />
		wms_order_check wms_order_check_
		<include refid="where_fragement" />
	</select>

	<!-- 插入记录 -->
	<insert id="create" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		<![CDATA[
		insert into wms_order_check (
									 check_id
									,order_no
									,order_type
									,order_status
									,area_code
									,diff_flag
									,goods_name
									,goods_code
									,location_code
									,remark
									,user_defined1
									,user_defined2
									,user_defined3
									,user_defined4
									,user_defined5
									,create_by
									,gmt_create
									,last_modified_by
									,gmt_modified
									,active_flag
		)values(
				   #{checkId}
			   ,#{orderNo}
			   ,#{orderType}
			   ,#{orderStatus}
			   ,#{areaCode}
			   ,#{diffFlag}
			   ,#{goodsName}
			   ,#{goodsCode}
			   ,#{locationCode}
			   ,#{remark}
			   ,#{userDefined1}
			   ,#{userDefined2}
			   ,#{userDefined3}
			   ,#{userDefined4}
			   ,#{userDefined5}
			   ,#{createBy}
			   ,#{gmtCreate}
			   ,#{lastModifiedBy}
			   ,#{gmtModified}
			   ,#{activeFlag}
			   )
		]]>
	</insert>

	<!-- 批量插入记录 -->
	<insert id="batchInsert" parameterType="java.util.List">
		insert into wms_order_check (
		check_id
		,order_no
		,order_type
		,order_status
		,area_code
		,diff_flag
		,goods_name
		,goods_code
		,location_code
		,remark
		,user_defined1
		,user_defined2
		,user_defined3
		,user_defined4
		,user_defined5
		,create_by
		,gmt_create
		,last_modified_by
		,gmt_modified
		,active_flag
		)
		values
		<foreach collection="list" item="item" index="index" separator="," >
			(
			#{item.checkId}
			,#{item.orderNo}
			,#{item.orderType}
			,#{item.orderStatus}
			,#{item.areaCode}
			,#{item.diffFlag}
			,#{item.goodsName}
			,#{item.goodsCode}
			,#{item.locationCode}
			,#{item.remark}
			,#{item.userDefined1}
			,#{item.userDefined2}
			,#{item.userDefined3}
			,#{item.userDefined4}
			,#{item.userDefined5}
			,#{item.createBy}
			,#{item.gmtCreate}
			,#{item.lastModifiedBy}
			,#{item.gmtModified}
			,#{item.activeFlag}
			)
		</foreach>
	</insert>

	<!-- 根据id，修改记录 -->
	<update id="update" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		<![CDATA[
		update wms_order_check set

			order_no = #{orderNo}
								 ,order_type = #{orderType}
								 ,order_status = #{orderStatus}
								 ,area_code = #{areaCode}
								 ,diff_flag = #{diffFlag}
								 ,goods_name = #{goodsName}
								 ,goods_code = #{goodsCode}
								 ,location_code = #{locationCode}
								 ,remark = #{remark}
								 ,user_defined1 = #{userDefined1}
								 ,user_defined2 = #{userDefined2}
								 ,user_defined3 = #{userDefined3}
								 ,user_defined4 = #{userDefined4}
								 ,user_defined5 = #{userDefined5}
								 ,create_by = #{createBy}
								 ,gmt_create = #{gmtCreate}
								 ,last_modified_by = #{lastModifiedBy}
								 ,gmt_modified = #{gmtModified}
								 ,active_flag = #{activeFlag}
		where check_id = #{checkId}
		]]>
	</update>

	<!--  -->
	<update id="updateBySelect" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		update wms_order_check <set>
		<if test="entity!=null">
			<if test="entity.checkId != null and entity.checkId !=''">

			</if>
			<if test="entity.orderNo != null and entity.orderNo !=''">
				<![CDATA[ order_no = #{entity.orderNo}, ]]>
			</if>
			<if test="entity.orderType != null and entity.orderType !=''">
				<![CDATA[ order_type = #{entity.orderType}, ]]>
			</if>
			<if test="entity.orderStatus != null and entity.orderStatus !=''">
				<![CDATA[ order_status = #{entity.orderStatus}, ]]>
			</if>
			<if test="entity.areaCode != null and entity.areaCode !=''">
				<![CDATA[ area_code = #{entity.areaCode}, ]]>
			</if>
			<if test="entity.diffFlag != null and entity.diffFlag !=''">
				<![CDATA[ diff_flag = #{entity.diffFlag}, ]]>
			</if>
			<if test="entity.goodsName != null and entity.goodsName !=''">
				<![CDATA[ goods_name = #{entity.goodsName}, ]]>
			</if>
			<if test="entity.goodsCode != null and entity.goodsCode !=''">
				<![CDATA[ goods_code = #{entity.goodsCode}, ]]>
			</if>
			<if test="entity.locationCode != null and entity.locationCode !=''">
				<![CDATA[ location_code = #{entity.locationCode}, ]]>
			</if>
			<if test="entity.remark != null and entity.remark !=''">
				<![CDATA[ remark = #{entity.remark}, ]]>
			</if>
			<if test="entity.userDefined1 != null and entity.userDefined1 !=''">
				<![CDATA[ user_defined1 = #{entity.userDefined1}, ]]>
			</if>
			<if test="entity.userDefined2 != null and entity.userDefined2 !=''">
				<![CDATA[ user_defined2 = #{entity.userDefined2}, ]]>
			</if>
			<if test="entity.userDefined3 != null and entity.userDefined3 !=''">
				<![CDATA[ user_defined3 = #{entity.userDefined3}, ]]>
			</if>
			<if test="entity.userDefined4 != null and entity.userDefined4 !=''">
				<![CDATA[ user_defined4 = #{entity.userDefined4}, ]]>
			</if>
			<if test="entity.userDefined5 != null and entity.userDefined5 !=''">
				<![CDATA[ user_defined5 = #{entity.userDefined5}, ]]>
			</if>
			<if test="entity.createBy != null and entity.createBy !=''">
				<![CDATA[ create_by = #{entity.createBy}, ]]>
			</if>
			<if test="entity.gmtCreate != null">
				<![CDATA[ gmt_create = #{entity.gmtCreate}, ]]>
			</if>
			<if test="entity.lastModifiedBy != null and entity.lastModifiedBy !=''">
				<![CDATA[ last_modified_by = #{entity.lastModifiedBy}, ]]>
			</if>
			<if test="entity.gmtModified != null">
				<![CDATA[ gmt_modified = #{entity.gmtModified}, ]]>
			</if>
			<if test="entity.activeFlag != null and entity.activeFlag !=''">
				<![CDATA[ active_flag = #{entity.activeFlag}, ]]>
			</if>
		</if>
	</set>
		where check_id = #{entity.checkId} and active_flag = '1'
	</update>

	<!-- 逻辑删除,根据主键设置active_flag ='0' -->
	<delete id="delete" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		delete from wms_order_check
		where check_id = #{entity.checkId} and active_flag = '1'
	</delete>

	<delete id="deleteByOrderNo" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		delete from wms_order_check
		where order_no = #{entity.orderNo} and active_flag = '1'
	</delete>

	<update id="batchDelete" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		DELETE FROM wms_order_check
		where check_id in
		<foreach collection="entity.checkIdList" index="index" item="item" open="(" separator="," close=")">
			#{item}
		</foreach>
	</update>

	<!-- 任意字段全匹配 -->
	<select id="queryByAny" resultMap="wmsOrderCheckMap" >
		select
		<include refid="selectAllColumns"/>
		<include refid="where_any" />
	</select>

	<select id="queryByAnyCount" resultType="long">
		<include refid="count_Tail" />
		wms_order_check wms_order_check_
		<include refid="where_any" />
	</select>

	<update id="updateByOrderNo" parameterType="com.penghaisoft.wms.storagemanagement.model.entity.WmsOrderCheck">
		update wms_order_check <set>
		<if test="entity!=null">
			<if test="entity.checkId != null and entity.checkId !=''">

			</if>
			<if test="entity.orderNo != null and entity.orderNo !=''">
				<![CDATA[ order_no = #{entity.orderNo}, ]]>
			</if>
			<if test="entity.orderType != null and entity.orderType !=''">
				<![CDATA[ order_type = #{entity.orderType}, ]]>
			</if>
			<if test="entity.orderStatus != null and entity.orderStatus !=''">
				<![CDATA[ order_status = #{entity.orderStatus}, ]]>
			</if>
			<if test="entity.areaCode != null and entity.areaCode !=''">
				<![CDATA[ area_code = #{entity.areaCode}, ]]>
			</if>
			<if test="entity.diffFlag != null and entity.diffFlag !=''">
				<![CDATA[ diff_flag = #{entity.diffFlag}, ]]>
			</if>
			<if test="entity.goodsName != null and entity.goodsName !=''">
				<![CDATA[ goods_name = #{entity.goodsName}, ]]>
			</if>
			<if test="entity.goodsCode != null and entity.goodsCode !=''">
				<![CDATA[ goods_code = #{entity.goodsCode}, ]]>
			</if>
			<if test="entity.locationCode != null and entity.locationCode !=''">
				<![CDATA[ location_code = #{entity.locationCode}, ]]>
			</if>
			<if test="entity.remark != null and entity.remark !=''">
				<![CDATA[ remark = #{entity.remark}, ]]>
			</if>
			<if test="entity.userDefined1 != null and entity.userDefined1 !=''">
				<![CDATA[ user_defined1 = #{entity.userDefined1}, ]]>
			</if>
			<if test="entity.userDefined2 != null and entity.userDefined2 !=''">
				<![CDATA[ user_defined2 = #{entity.userDefined2}, ]]>
			</if>
			<if test="entity.userDefined3 != null and entity.userDefined3 !=''">
				<![CDATA[ user_defined3 = #{entity.userDefined3}, ]]>
			</if>
			<if test="entity.userDefined4 != null and entity.userDefined4 !=''">
				<![CDATA[ user_defined4 = #{entity.userDefined4}, ]]>
			</if>
			<if test="entity.userDefined5 != null and entity.userDefined5 !=''">
				<![CDATA[ user_defined5 = #{entity.userDefined5}, ]]>
			</if>
			<if test="entity.createBy != null and entity.createBy !=''">
				<![CDATA[ create_by = #{entity.createBy}, ]]>
			</if>
			<if test="entity.gmtCreate != null">
				<![CDATA[ gmt_create = #{entity.gmtCreate}, ]]>
			</if>
			<if test="entity.lastModifiedBy != null and entity.lastModifiedBy !=''">
				<![CDATA[ last_modified_by = #{entity.lastModifiedBy}, ]]>
			</if>
			<if test="entity.gmtModified != null">
				<![CDATA[ gmt_modified = #{entity.gmtModified}, ]]>
			</if>
			<if test="entity.activeFlag != null and entity.activeFlag !=''">
				<![CDATA[ active_flag = #{entity.activeFlag}, ]]>
			</if>
		</if>
	</set>
		where order_no = #{entity.orderNo} and active_flag = '1'
	</update>

	<select id="queryList1" resultMap="wmsOrderCheckMap" >
		SELECT
		<if test="page!=null">
			<include refid="pagination_tail" />
		</if>
		check_id,
		diff_flag,
		order_no,
		order_type,
		order_status,
		area_code,
		goods_code,
		goods_name,
		location_code,
		gmt_create,
		planPalletAmount,
		realPalletAmount,
		planGoodsAmount,
		realGoodsAmount,
		user_defined2
		FROM
		(
		SELECT
		wms_order_check_.check_id,
		<![CDATA[CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0 END diff_flag,]]>
		wms_order_check_.order_no,
		wms_order_check_.order_type,
		wms_order_check_.order_status,
		wms_order_check_.area_code,
		wms_order_check_.goods_code,
		wms_order_check_.goods_name,
		wms_order_check_.location_code,
		wms_order_check_.gmt_create,
		wms_order_check_.user_defined2,
		sum(
		CASE
		WHEN s.amount IS NULL THEN
		0
		WHEN s.amount = '' THEN
		0
		ELSE
		1
		END
		) planPalletAmount,
		sum(s.user_defined1) realPalletAmount,
		sum(s.amount) planGoodsAmount,
		sum(s.real_amount) realGoodsAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '2'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		GROUP BY
		wms_order_check_.order_no,
		wms_order_check_.goods_code
		UNION
		SELECT
		wms_order_check_.check_id,
		<![CDATA[CASE WHEN sum(s.diff_flag) > 0 THEN 1 ELSE 0 END diff_flag,]]>
		wms_order_check_.order_no,
		wms_order_check_.order_type,
		wms_order_check_.order_status,
		wms_order_check_.area_code,
		wms_order_check_.goods_code,
		wms_order_check_.goods_name,
		wms_order_check_.location_code,
		wms_order_check_.gmt_create,
		wms_order_check_.user_defined2,
		sum(
		CASE
		WHEN s.amount IS NULL THEN
		0
		WHEN s.amount = '' THEN
		0
		ELSE
		1
		END
		) planPalletAmount,
		sum(s.user_defined1) realPalletAmount,
		sum(s.amount) planGoodsAmount,
		sum(s.real_amount) realGoodsAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '1'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		GROUP BY
		wms_order_check_.order_no,
		wms_order_check_.location_code
		) a
		<if test="entity.orderBy != null and entity.orderBy !=''">
			<![CDATA[ order by ${entity.orderBy}]]>
		</if>
		<if test="entity.orderBy == null or entity.orderBy ==''">
			<![CDATA[ order by gmt_create desc]]>
		</if>

	</select>


	<!--sqlserver 查询语句修改 - 盘点新增 -列表查询-->
	<select id="queryListToSqlServer" resultMap="wmsOrderCheckMap" >
		SELECT
		<if test="page!=null">
			<include refid="pagination_tail" />
		</if>
		check_id,
		diff_flag,
		order_no,
		order_type,
		order_status,
		area_code,
		goods_code,
		goods_name,
		location_code,
		gmt_create,
		planPalletAmount,
		realPalletAmount,
		planGoodsAmount,
		realGoodsAmount,
		user_defined2
		FROM
		(
		SELECT
		wms_order_check_.check_id,
		<![CDATA[CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0 END diff_flag,]]>
		wms_order_check_.order_no,
		wms_order_check_.order_type,
		wms_order_check_.order_status,
		wms_order_check_.area_code,
		wms_order_check_.goods_code,
		wms_order_check_.goods_name,
		wms_order_check_.location_code,
		wms_order_check_.gmt_create,
		wms_order_check_.user_defined2,
		(SELECT	SUM ( CASE WHEN s.amount IS NULL THEN 0 WHEN s.amount = '' THEN 0 ELSE 1 END )  FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2'  ) planPalletAmount,
		(SELECT	SUM ( cast(s.user_defined1 as bigint))  FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2' ) realPalletAmount,
		(SELECT	SUM ( s.amount )   FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2'  ) planGoodsAmount,
		(SELECT SUM ( s.real_amount )   FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2'  ) realGoodsAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '2'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		UNION
		SELECT
		wms_order_check_.check_id,
		<![CDATA[CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0 END diff_flag,]]>
		wms_order_check_.order_no,
		wms_order_check_.order_type,
		wms_order_check_.order_status,
		wms_order_check_.area_code,
		wms_order_check_.goods_code,
		wms_order_check_.goods_name,
		wms_order_check_.location_code,
		wms_order_check_.gmt_create,
		wms_order_check_.user_defined2,
		(SELECT	SUM ( CASE WHEN s.amount IS NULL THEN 0 WHEN s.amount = '' THEN 0 ELSE 1 END )  FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2' ) planPalletAmount,
		(SELECT	SUM ( cast(s.user_defined1 as bigint))  FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2' ) realPalletAmount,
		(SELECT	SUM ( s.amount )   FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2'  ) planGoodsAmount,
		(SELECT SUM ( s.real_amount )   FROM wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id WHERE  wms_order_check_.order_type = '2'  ) realGoodsAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '1'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		) a
		<if test="entity.orderBy != null and entity.orderBy !=''">
			<![CDATA[ order by ${entity.orderBy}]]>
		</if>
		<if test="entity.orderBy == null or entity.orderBy ==''">
			<![CDATA[ order by gmt_create desc]]>
		</if>

	</select>

	<select id="queryCount1" resultType="long">
		SELECT
		count(1)
		FROM
		(
		SELECT
		wms_order_check_.check_id,
		wms_order_check_.order_no,
		wms_order_check_.order_type,
		wms_order_check_.order_status,
		wms_order_check_.area_code,
		wms_order_check_.goods_code,
		wms_order_check_.goods_name,
		wms_order_check_.location_code,
		wms_order_check_.gmt_create,
		wms_order_check_.user_defined2,
		<![CDATA[sum( CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0  END)  diff_flag ,]]>
		sum(
		CASE
		WHEN s.amount IS NULL THEN
		0
		WHEN s.amount = '' THEN
		0
		ELSE
		1
		END
		) planPalletAmount,
		sum(s.user_defined1) realPalletAmount,
		sum(s.amount) planGoodsAmount,
		sum(s.real_amount) realGoodsAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '2'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		GROUP BY
		s.diff_flag,
		wms_order_check_.order_no,
		wms_order_check_.check_id,
		wms_order_check_.goods_code
		,wms_order_check_.order_type
		UNION
		SELECT
		wms_order_check_.check_id,
		wms_order_check_.order_no,
		wms_order_check_.order_type,
		wms_order_check_.order_status,
		wms_order_check_.area_code,
		wms_order_check_.goods_code,
		wms_order_check_.goods_name,
		wms_order_check_.location_code,
		wms_order_check_.gmt_create,
		wms_order_check_.user_defined2,
		<![CDATA[sum( CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0  END)  diff_flag ,]]>
		sum(
		CASE
		WHEN s.amount IS NULL THEN
		0
		WHEN s.amount = '' THEN
		0
		ELSE
		1
		END
		) planPalletAmount,
		sum(s.user_defined1) realPalletAmount,
		sum(s.amount) planGoodsAmount,
		sum(s.real_amount) realGoodsAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '1'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		GROUP BY
		s.diff_flag,
		wms_order_check_.order_no,
		wms_order_check_.location_code
		,wms_order_check_.order_type
		) a
	</select>


	<!--解决SQL server中，字段无效，因为该列没有包含在聚合函数或 GROUP BY 子句中，的问题-->
	<select id="queryCount_sqlserver" resultType="long">
		SELECT
		count(1)
		FROM
		(
		SELECT
		wms_order_check_.order_no,
		<![CDATA[sum( CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0  END)  diff_flag ,]]>
		sum(
		CASE
		WHEN s.amount IS NULL THEN
		0
		WHEN s.amount = '' THEN
		0
		ELSE
		1
		END
		) planPalletAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '2'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		GROUP BY
		s.diff_flag,
		wms_order_check_.order_no,
		wms_order_check_.check_id,
		wms_order_check_.goods_code
		UNION
		SELECT
		wms_order_check_.order_no,
		<![CDATA[sum( CASE WHEN s.diff_flag > 0 THEN 1 ELSE 0  END)  diff_flag ,]]>
		sum(
		CASE
		WHEN s.amount IS NULL THEN
		0
		WHEN s.amount = '' THEN
		0
		ELSE
		1
		END
		) planPalletAmount
		FROM
		wms_order_check wms_order_check_
		LEFT JOIN wms_order_check_pallet s ON wms_order_check_.check_id = s.check_id
		WHERE
		wms_order_check_.order_type = '1'
		<if test="entity.orderNo != null and entity.orderNo !=''">
			<![CDATA[ and wms_order_check_.order_no LIKE CONCAT('%',#{entity.orderNo},'%')]]>
		</if>
		<if test="entity.orderType != null and entity.orderType !=''">
			<![CDATA[ and wms_order_check_.order_type LIKE CONCAT('%',#{entity.orderType},'%')]]>
		</if>
		<if test="entity.orderStatus != null and entity.orderStatus !=''">
			<![CDATA[ and wms_order_check_.order_status LIKE CONCAT('%',#{entity.orderStatus},'%')]]>
		</if>
		<if test="entity.areaCode != null and entity.areaCode !=''">
			<![CDATA[ and wms_order_check_.area_code LIKE CONCAT('%',#{entity.areaCode},'%')]]>
		</if>
		<if test="entity.diffFlag != null and entity.diffFlag !=''">
			<![CDATA[ and wms_order_check_.diff_flag LIKE CONCAT('%',#{entity.diffFlag},'%')]]>
		</if>
		<if test="entity.goodsName != null and entity.goodsName !=''">
			<![CDATA[ and wms_order_check_.goods_name LIKE CONCAT('%',#{entity.goodsName},'%')]]>
		</if>
		<if test="entity.goodsCode != null and entity.goodsCode !=''">
			<![CDATA[ and wms_order_check_.goods_code LIKE CONCAT('%',#{entity.goodsCode},'%')]]>
		</if>
		<if test="entity.locationCode != null and entity.locationCode !=''">
			<![CDATA[ and wms_order_check_.location_code LIKE CONCAT('%',#{entity.locationCode},'%')]]>
		</if>
		GROUP BY
		s.diff_flag,
		wms_order_check_.order_no,
		wms_order_check_.location_code
		) a
	</select>
</mapper>